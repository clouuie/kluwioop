@page "/"
@using System.ComponentModel.DataAnnotations
@using Microsoft.AspNetCore.Components.Forms
@inject NavigationManager Navigation

<div class="login-page">
    <div class="login-card shadow">
        <h2 class="text-center mb-3">Welcome Back!</h2>
        <p class="text-center text-muted mb-4">Please sign in to continue</p>

        @if (isLoggedIn)
        {
            <div class="alert alert-success" role="alert">
                Logged in as @loginModel.Username
            </div>
        }

        <EditForm Model="@loginModel" OnValidSubmit="HandleValidSubmit">
            <DataAnnotationsValidator />
            <ValidationSummary />

            <div class="mb-3 text-start">
                <label class="form-label">Username</label>
                <InputText class="form-control" @bind-Value="loginModel.Username" placeholder="Enter username" />
                <ValidationMessage For="@(() => loginModel.Username)" />
            </div>

            <div class="mb-3 text-start password-group">
                <label class="form-label">Password</label>
                <InputText class="form-control" @bind-Value="loginModel.Password" type="password" placeholder="Enter password" />
                <ValidationMessage For="@(() => loginModel.Password)" />
            </div>

            <div class="d-flex justify-content-between align-items-center mb-3 remember-forgot">
                <div class="form-check text-start">
                    <InputCheckbox class="form-check-input" @bind-Value="loginModel.RememberMe" id="rememberMe" />
                    <label class="form-check-label" for="rememberMe">Remember Me</label>
                </div>
                <a class="small text-primary" href="/forgot-password">Forgot Password?</a>
            </div>

            <button class="btn btn-primary login-btn" type="submit">Login</button>
        </EditForm>

        <div class="mt-4 text-center extra-space">
            <span class="text-muted">Don’t have an account?</span>
            <a class="text-primary ms-1 register-link" href="/register"><b>Register</b></a>
        </div>
    </div>
</div>

<style>
/* === Layout === */
.login-page {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background-color: #1a0728;
    font-family: 'Poppins', sans-serif;
}

/* === Card === */
.login-card {
    background-color: #2a0a45;
    border-radius: 10px;
    padding: 30px;
    width: 340px;
    box-shadow: 0 0 10px rgba(150, 80, 255, 0.2);
    text-align: center;
}

/* === Headings === */
h2 {
    color: #f0e5ff;
    font-size: 1.5rem;
    margin-bottom: 10px;
}

p {
    color: #c5b3e6;
    font-size: 0.9rem;
    margin-top: 8px;
    margin-bottom: 20px;
}

/* === Labels and Inputs === */
.form-label {
    color: #e2d0ff;
    font-size: 0.9rem;
    margin-bottom: 5px;
    display: block;
    text-align: left;
}

.form-control {
    width: 95%;
    padding: 10px;
    border-radius: 6px;
    border: 1px solid #8057c8;
    background-color: #3b1563;
    color: white;
    font-size: 0.9rem;
    margin-top: 4px;
    margin-bottom: 14px;
}

.form-control::placeholder {
    color: #c3a8f0;
}

.form-control:focus {
    outline: none;
    border-color: #a56dff;
    box-shadow: 0 0 3px #a56dff;
}

/* === Form Group Spacing === */
.mb-3 {
    margin-bottom: 18px;
}

/* Reduce space only for the password group */
.password-group {
    margin-bottom: 0;
}
.password-group .form-control {
    margin-bottom: 0;
}

/* === Remember Me + Forgot Password === */
.remember-forgot {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.form-check {
    display: flex;
    align-items: center;
    gap: 6px;
}

.form-check-label {
    color: #d4c2f3;
    font-size: 0.85rem;
}

/* === Links === */
a {
    color: #b48fff;
    text-decoration: none;
    font-size: 0.85rem;
}

a:hover {
    text-decoration: underline;
}

/* === Button === */
.btn-primary {
    background-color: #8b4dff;
    border: none;
    border-radius: 6px;
    padding: 10px;
    color: #fff;
    font-weight: 500;
    text-align: center;
    display: flex;
    justify-content: center;
    align-items: center;
}

.btn-primary:hover {
    background-color: #a068ff;
}

/* === Login Button (same width as textboxes) === */
.login-btn {
    width: 100%; /* same as textboxes */
    height: 40px;
    margin-top: 8px;
    margin-bottom: 20px;
    font-size: 1rem;
    text-align: center;
    display: flex;
    justify-content: center;
    align-items: center;
}

/* === Extra Space Below Login Button === */
.extra-space {
    margin-top: 25px; /* more space before the register text */
}

/* === Other Text === */
.text-muted {
    color: #bfa4e9 !important;
}

/* === Register Link === */
.register-link {
    font-weight: bold;
}

/* === Responsive === */
@@media (max-width: 500px) {
    .login-card {
        width: 90%;
        padding: 20px;
    }
}
</style>

@code {
    private LoginModel loginModel = new();
    private bool isLoggedIn;

    private void HandleValidSubmit()
    {
        isLoggedIn = true;
        // Navigation.NavigateTo("/dashboard");
    }

    private class LoginModel
    {
        [Required(ErrorMessage = "Username is required")]
        public string? Username { get; set; }

        [Required(ErrorMessage = "Password is required")]
        public string? Password { get; set; }

        public bool RememberMe { get; set; }
    }
}
